{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Escáner QR</title>
</head>
<body>
    {% if is_admin %}
        <h2>Escanear QR</h2>
        <div id="reader" style="width:400px; margin-top:20px;"></div>

        <!-- Primero cargamos la librería -->
        <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>

        <!-- Luego iniciamos el escáner solo cuando el DOM esté listo -->
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const html5QrCode = new Html5Qrcode("reader");

                html5QrCode.start(
                    { facingMode: "environment" }, 
                    { fps: 10, qrbox: 250 },
                    qrCodeMessage => { 
                        alert("Código escaneado: " + qrCodeMessage);
                    }
                ).catch(err => {
                    console.error("Error al iniciar cámara:", err);
                });
            });
        </script>
    {% else %}
        <h2>Acceso restringido</h2>
        <p style="color: red; font-weight: bold;">
            No tienes permisos para acceder a esta funcionalidad.
        </p>
    {% endif %}
</body>
</html>
